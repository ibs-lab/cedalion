{% if READTHEDOCS or display_lower_left %}
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Version:</span>
      <span id="current-version">Loading...</span>
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl id="version-list">
        <dt>{{ _('Versions') }}</dt>
      </dl>
    </div>
  </div>
  <script>
    document.addEventListener("DOMContentLoaded", function() {
  fetch("/versions.json") // Load the versions.json file
    .then(response => response.json())
    .then(data => {
      const versionList = document.getElementById("version-list");
      const currentVersionElement = document.getElementById("current-version");
      const currentUrl = window.location.href;
      let currentVersion = "Unknown"; // Default if no match

      versionList.innerHTML = "<dt>Versions</dt>";

      data.forEach(({ label, url }) => {
        const dd = document.createElement("dd");
        const a = document.createElement("a");
        a.href = url;
        a.textContent = label;

        // Check if the current URL starts with the version URL
        if (currentUrl.startsWith(url) || currentUrl.includes(url)) {
          a.style.fontWeight = "bold";
          currentVersion = label;
        }

        dd.appendChild(a);
        versionList.appendChild(dd);
      });

      // Update the displayed current version name
      currentVersionElement.textContent = currentVersion;
    })
    .catch(error => {
      console.error("Error loading versions.json:", error);
      document.getElementById("current-version").textContent = "Unknown";
    });
});
  </script>
{% endif %}